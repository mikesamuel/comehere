<!doctype html><html><meta charset="utf-8"><title>Rebooting printf debugging</title><link rel="stylesheet" href="/comehere/index.113501a2.css"><link rel="stylesheet" href="/comehere/index.50984f90.css"><body> <h1>Rebooting printf debugging<br><small>Towards scanf debugging</small></h1> <p> Printf debugging is no substitute for robust, automated test suites, but it is a critical practice in exploring, understanding, and debugging code. JavaScript introduced the <code>debugger</code> keyword almost thirty years ago to aid in debugging. But the language has only added one feature since then to explicitly aid debugging: <code>console</code>. </p> <p> We are proud to announce a JavaScript language proposal to make it easier to printf debug large JavaScript projects. This is the culmination of research by many brilliant people at (TODO: fake organization). </p> <p> Below, you can see the proposal in action! Imagine you're debugging a piece of code. You suspect that some inputs to a <i>deeply nested helper function</i> will help you understand what's going on. But getting the right inputs to that function requires reverse engineering a <i>program input</i> that would cause the desired function call. That's now unnecessary. Simply tell the program to <big><code>COMEHERE</code></big> with the inputs you want, and it will. </p> <table id="editor-table"> <tr id="scroll-back-button-row" style="display:none"> <td width="50%" colspan="2" align="center"> <button id="scroll-back-button">Go back to article &#x2935;</button> </td> </tr> <tr> <td valign="top" width="50%"><div id="editor"></div> <button id="play-button" type="button" title="Run the code in the editor on the left">‚ñ∂Ô∏è</button> <select id="block-choice"></select> <p> <big>‚¨ë</big> That play button runs the code. The selector lets you pick which <big><code>COMEHERE</code></big> block to run. </p> <div id="console-output"></div></td> <td valign="top" width="50%"><div id="translation"></div></td> </tr> </table> <script type="module" src="/comehere/index.b58242d4.js"></script> <p> On the left you can see a sample program that uses <big><code>COMEHERE:with</code></big> to cause a function to be called with certain inputs. And then it logs those outputs. It's <i>printf debugging on steroids</i>! </p> <p> Hit the <i>play</i> button below the editor to see the console output from the <big><code>COMEHERE</code></big> block body. Below are the parts of a <big><code>COMEHERE</code></big> block: </p> <ul> <li>There's a syntactic marker. This is placeholder syntax that let's us integrate the proposal into existing toolchains. </li><li>If there's a quoted string right after the open parenthesis, it's a <i>description</i>. It's optional but providing it helps tools like the developer console make it easy to pick the right block when interactively debugging a module. </li><li>Then there are zero or more <i>assignments</i>. This lets the developer control the values of inputs to functions and class instances that contain the target <big><code>COMEHERE</code></big> block. </li><li>Finally, there's a <i>body</i>, statements to run that help the developer understand their code.</li> </ul> <style>span.part-marker{border:1px dashed #44d;position:relative}span.part-marker>span{text-wrap:nowrap;background:#ccf;border:1px dotted #44d;font-size:8pt;position:absolute}span.part-marker#part-marking-syntax>span,span.part-marker#part-desc>span,span.part-marker#part-assigns>span{top:-2.5ex}span.part-marker#part-marking-syntax>span{left:2em}span.part-marker#part-desc>span{left:.75em}span.part-marker#part-assigns>span{left:1.5em}span.part-marker#part-body>span{bottom:-2.5ex}#annotated-syntax-example{padding-left:3em}</style> <p id="annotated-syntax-example"><br> <code><span class="part-marker" id="part-marking-syntax"><span>Syntactic marker</span>COMEHERE:with</span> (<span class="part-marker" id="part-desc"><span>Optional description</span>"Lorem Ipsum"</span>, <span class="part-marker" id="part-assigns"><span>Desired bindings</span>x = 1, y = 2</span>) { <br>&nbsp; <span class="part-marker" id="part-body"><span>Statements to run</span>body;</span> <br>}</code> </p> <p> <big><code>COMEHERE</code></big> works by &ldquo;driving control&rdquo; to the block. Look at the top line of the translation on the right above; when <code>seeking_0</code> is <code>1</code>, it'll call the containing function, and within it, will log some information about intermediate values. </p> <p> With <big><code>COMEHERE</code></big>, loading the module has the side-effect of letting the user (via <code>debugHooks</code>) choose what to debug and logging valuable information. No need to reverse engineer program state to explore what's going wrong. But when <code>seeking_0</code> is 0, it has no semantic effect on the code. </p> <p> &ldquo;Driving control&rdquo; means making branching choices that end up running the chosen <big><code>COMEHERE</code></big> blocks. In the below you can see two blocks. <small>(Hit the 'üìã' button to play with the example code in the editor above.)</small> If <code>seeking_0</code> is 1 then it ignores the result of <code>Math.random()</code> and jumps into the <i>then</i> branch regardless; if it's 2 it jumps into the <i>else</i> branch regardless; otherwise it runs as if there were no <big><code>COMEHERE</code></big> blocks at all. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span><span class="p">;</span>
<span class="w">  </span><span class="nx">n</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;then-branch&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">28</span><span class="p">;</span>
<span class="w">  </span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;else-branch&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:18ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span><span class="p">;</span>
<span class="w">  </span><span class="nx">n</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">28</span><span class="p">;</span>
<span class="w">  </span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p> Similar code translation tricks drive control into other constructs &hellip; </p> <p>Loops bodies:</p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="c1">// Can drive into a loop by instrumenting the</span>
<span class="c1">// condition/iterator.</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span>

<span class="w">    </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;in a loop&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">square</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:13ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="c1">// Can drive into a loop by instrumenting the</span>
<span class="c1">// condition/iterator.</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">square</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">,</span>
<span class="w">      </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">callee_0</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p>Switch cases:</p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="c1">// Can drive into a switch block by synthesizing</span>
<span class="c1">// fall-through cases using sentinel values.</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">vowels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;aeiou&#39;</span><span class="p">;</span>

<span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">vowels</span><span class="p">[(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;e&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="p">(</span><span class="s1">&#39;in case e&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got to case e&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;i&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;o&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;u&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:26ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="c1">// Can drive into a switch block by synthesizing</span>
<span class="c1">// fall-through cases using sentinel values.</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">vowels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;aeiou&#39;</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">caseToken_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{},</span>
<span class="w">  </span><span class="nx">caseExpr_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">vowels</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">caseToken_0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">caseExpr_0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;e&#39;</span><span class="o">:</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="nx">caseToken_0</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got to case e&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;i&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;o&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;u&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p>Catch blocks inside try statements:</p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="c1">// Can drive into a catch block by throwing when</span>
<span class="c1">// seeking has the required value.</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Maybe causing a throw here is unnecessarily difficult;</span>
<span class="w">  </span><span class="c1">// it can be convenient to be able to specify how to</span>
<span class="w">  </span><span class="c1">// construct the value to catch.</span>
<span class="w">  </span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;to catch&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Hi&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;caught&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:14ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="c1">// Can drive into a catch block by throwing when</span>
<span class="c1">// seeking has the required value.</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Hi&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;caught&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p>Members in classes:</p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="c1">// Driving into a class member requires a `this` value.</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">get</span><span class="w"> </span><span class="nx">x</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// One can specify inputs to the constructor in which</span>
<span class="w">    </span><span class="c1">// case it synthesizes an insance.</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="p">;</span>
<span class="w">    </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;getter for x&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">42</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">method</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Or one can say use this particular value for `this`.</span>
<span class="w">    </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">.</span><span class="k">this</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;. method(&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sb">`C(</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="si">}</span><span class="sb">)`</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:26ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="c1">// Driving into a class member requires a `this` value.</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">get</span><span class="w"> </span><span class="nx">x</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;this._x =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// One can specify inputs to the constructor in which</span>
<span class="w">    </span><span class="c1">// case it synthesizes an insance.</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">method</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1n</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Or one can say use this particular value for `this`.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;. method(&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`C(</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">_x</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">this_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<span class="w">      </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">this_1</span><span class="p">.</span><span class="nx">method</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">42</span><span class="p">,</span>
<span class="w">      </span><span class="nx">this_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">this_0</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p> Short-circuiting expressions, expressions that blur the distinction between expressions and control flow. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span>
<span class="w">  </span><span class="o">?</span><span class="w"> </span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="p">(</span><span class="s1">&#39;In ? of hook&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;in ?&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">})()</span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:10ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="nx">f_0</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f_0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">      </span><span class="nx">callee_0</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">f_0</span><span class="p">;</span>
<span class="p">})(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;in ?&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="p">})()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</pre></div> </td></tr></table> <p> Below is a tricky example. A recursive function that recurses <i>before</i> reaching the <big><code>COMEHERE</code></big> block. If the translation wasn't careful, <code>n</code> would be 2 when it was first reached instead of 10 as requested. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="c1">// This example shows a COMEHERE block running</span>
<span class="c1">// with the arguments given even though the body</span>
<span class="c1">// recurses before, so the first time the COMEHERE</span>
<span class="c1">// block is seen, n is actually 2.</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="nx">$$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">));</span>

<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;fib(10)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">$$1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">Function</span><span class="p">.</span><span class="k">return</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:16ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="c1">// This example shows a COMEHERE block running</span>
<span class="c1">// with the arguments given even though the body</span>
<span class="c1">// recurses before, so the first time the COMEHERE</span>
<span class="c1">// block is seen, n is actually 2.</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">],</span>
<span class="w">    </span><span class="nx">$$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;fibonacci(n - 2) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">$$1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;fibonacci(n - 1) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">$$1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fibonacci</span><span class="p">,</span>
<span class="w">      </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">callee_0</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p> Another thing to note is that, when one or more <big><code>COMEHERE</code></big> blocks occur right after a <code>return</code> statement, they can run and the special expression <code>Function.return</code> refers to the returned value. (That syntax only works inside those blocks) </p> <p> We asked more than twenty veteran printf-debuggers, &ldquo;if you could make one change to printf to make it even more obviously the best way to debug programs, what would it be?&rdquo; Unanimously, they wanted to print a value alongside the code that produced it. </p> <p> Any variable that starts with two dollar-signs (<code>$$0</code>, <code>$$foo</code>, etc.), and which is not defined in the containing module is treated specially: </p> <ul> <li>We create a definition in the deepest function or module body that contains all references to that variable. </li><li>When the variable is assigned, we store information about the code that derived the new value. </li><li>When the variable is used in a spread (<code>...$$0</code>), the code precedes the value. </li></ul> <p> That enables wrapping a complex intermediate expression in <code>($$0 = complexIntermediate())</code> followed by <code>console.log(...$$0)</code>. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">12</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">37</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">42</span><span class="p">;</span>

<span class="c1">// What if we want to know the value of an</span>
<span class="c1">// intermediate expression like</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.05</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// We could type out the expression.</span>
<span class="w">  </span><span class="c1">// But as we debug, the logging can get out of sync</span>
<span class="w">  </span><span class="c1">// with the code.</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a * b =&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c / d =&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.05</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// $$name shorthand lets you give a name to an intermediate</span>
<span class="w">  </span><span class="c1">// expression.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">$$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">);</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;$$ demo&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// When you &quot;spread&quot; a $$name variable, you get both</span>
<span class="w">    </span><span class="c1">// the expression source code and the value.</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">$$1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:24ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span>
<span class="w">  </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">12</span><span class="p">,</span>
<span class="w">  </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">37</span><span class="p">,</span>
<span class="w">  </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">42</span><span class="p">;</span>

<span class="c1">// What if we want to know the value of an</span>
<span class="c1">// intermediate expression like</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.05</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// We could type out the expression.</span>
<span class="w">  </span><span class="c1">// But as we debug, the logging can get out of sync</span>
<span class="w">  </span><span class="c1">// with the code.</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a * b =&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c / d =&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">],</span>
<span class="w">    </span><span class="nx">$$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="w">  </span><span class="c1">// $$name shorthand lets you give a name to an intermediate</span>
<span class="w">  </span><span class="c1">// expression.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">((</span><span class="nx">$$0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a * b =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nx">$$1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;c / d =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">d</span><span class="p">));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// When you &quot;spread&quot; a $$name variable, you get both</span>
<span class="w">    </span><span class="c1">// the expression source code and the value.</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">$$1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p> And if the $$name variable is assigned along multiple paths, that code reflects the last affecting intermediate expression. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">abs</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// When there&#39;s more than one assignment,</span>
<span class="w">  </span><span class="c1">// the source code gives you a clue as to which</span>
<span class="w">  </span><span class="c1">// branch generated the value for $$0.</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span>
<span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nx">n</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Logs &quot;-n = 10&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;non-negative&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Logs &quot;+n = 1.23&quot; or something like that depending on</span>
<span class="w">    </span><span class="c1">// the randomly chosen n.</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:18ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">abs</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">$$0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;undefined&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">$$0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;+n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">$$0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Logs &quot;-n = 10&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">$$0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Logs &quot;+n = 1.23&quot; or something like that depending on</span>
<span class="w">    </span><span class="c1">// the randomly chosen n.</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// When there&#39;s more than one assignment,</span>
<span class="w">  </span><span class="c1">// the source code gives you a clue as to which</span>
<span class="w">  </span><span class="c1">// branch generated the value for $$0.</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">abs</span><span class="p">,</span>
<span class="w">      </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">callee_1</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">abs</span><span class="p">,</span>
<span class="w">      </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">10</span><span class="p">;</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">callee_0</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p> But wait, there's more! If we can super-charge <i>printf debugging</i>, what about other format string functions? We pored over both <i>"stdio.h"</i> and <i>&laquo;stdio.h&raquo;</i>, and we're super proud to announce that COMEHERE enables an entirely new debugging paradigm: <i>scanf debugging</i>. </p> <p> Below, the arguments for the function come from interactive browser functions. </p> <table class="example-display"><tr valign="top"><td class="left" width="50%"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">square</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>

<span class="w">  </span><span class="nx">COMEHERE</span><span class="o">:</span><span class="kd">with</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;square it&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;square(&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;) returns&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">Function</span><span class="p">.</span><span class="k">return</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td><td class="right" width="50%"><div class="highlight" style="height:8ex"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">globalThis</span><span class="p">.</span><span class="nx">debugHooks</span><span class="p">.</span><span class="nx">getWhichSeeking</span><span class="p">(</span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">square</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">0n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isActiveCall_0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;square(&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;) returns&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">functionReturn_0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">callee_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">square</span><span class="p">,</span>
<span class="w">      </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="nx">activeFns_0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">0n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">callee_0</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">seeking_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div> </td></tr></table> <p>TODO: Be super defensive about being a low rent version of <a href="https://www.youtube.com/watch?v=PUv66718DII&amp;list=PLS4RYH2XfpAmswi1WDU6lwwggruEZrlPH">&ldquo;Inventing on Principle&rdquo;</a>.</p> <p> TODO: decorator that recurses before call corner-case discussion. Decorators, unlike function proxies, intercept simple calls by name. A decorator that wraps a function in a way that recurses with different arguments before invoking with the arguments would observe activeFns in an unintentional state. There are solutions to this problem but they involve work beyond the scope of this demo: desugaring function hoisting and decorator application. </p> <p> TODO: call to action with insinuation that powerful people don't want to COMEHERE </p> </body></html>